<script type="text/javascript"></script>

<!-- <script src="program.wasm.js" wasm='program.wasm' type="text/javascript"></script>  -->
<script type="text/javascript">
    // This is googles recommended way of loading WebAssembly.
    async function test() {
        try {
            const response = await fetch('main.wasm')
            const buffer = await response.arrayBuffer();
            const module = new WebAssembly.Module(buffer);
            //const module = await WebAssembly.compileStreaming(fetch('program.wasm'));
            const instance = await WebAssembly.instantiate(module);
            //const { instance } = await WebAssembly.instantiateStreaming(fetch('program.wasm'));
            // alert('okkiii')
            if (instance.exports.main)
                result = instance.exports.main()
            else if (instance.exports.wasp_main)
                result = instance.exports.wasp_main()
            else result = instance.exports//show what we've got
            console.log(result);
            // alert(result)
        } catch (error) {
            alert(error + "\n RUN as\n sudo python3 -m http.server")
        }
    }

    test()
</script>