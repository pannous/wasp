# hyperreals ( namespace implicit by file name )

# https://en.wikipedia.org/wiki/Hyperreal_number


axioms{
	Îµ = epsilon # builtin!
	Ï‰ = omega

	Ï‰ â‰ˆ âˆ
	Îµ â‰ˆ 0

# âˆš-1=Ã¯ # this way round, because we extend the âˆš function!

	#1/0 = âˆ
	1/0 = Ï‰
	1/Ï‰ = Îµ
	1/âˆ = 0
}


#ğ•€ infinitesimal numbers
ğ•€ = span field <Îµ, Ï‰>
â„â‹† = â„(Îµ, Ï‰) # ordered field extension
â„â‹† = â„Ã—ğ•€   

class HyperReal is Number {
	# class â„â‹† 
	alias Hyper

# hyperreals â„â‹† are an ordered field extension of â„

	Number real alias real part, re, standard part, st, shadow, sh
	Number epsilon alias ep, eps # âš ï¸ todo unlike Complex numbers Îµ^2 â‰  Îµ ?
	Number omega alias om

# transfer principle:  
# first-order statements about â„ are also valid in â„â‹†

	times(number) = Hyper(this.real*number,this.epsilon, this.omega)
	plus(number)  = Hyper(this.real+number,this.epsilon, this.omega) # â€¦
	ğ‘â‰ƒğ‘ if a.real = b.real
}



# external definition as in Julia
times(Ï‰,Îµ) = 1
times(Îµ,Ï‰) = 1
times(number x,hyper y) = Hyper(x*y.real,x*y.epsilon, x*y.omega)
times(hyper x,hyper y) = Hyper(x.real*y.real,x.real*y.epsilon+y.real*x.epsilon, hyper.omega)
times(hyper x,Îµ) = Hyper(0, x.real, 0)
times(hyper x,Îµ) = Hyper(0, x.real, 0)
Îµ, 

epsilon := Hyper(0,1,0)
omega := Hyper(0,0,1)

âš ï¸ free standing Îµ vs x.Îµ






# Applications

operator âˆ‚ "define the derivative algebraically"
âˆ‚f(x)=(f(x+Îµ)-f(x))/Îµ
# e.g 
# f(x)=x^2 
# âˆ‚f(x)=((x+Îµ)^2)-x^2)/Îµ = (2xÎµ + Îµ^2)/Îµ = 2x + Îµ 


real derivative (f) = st(âˆ‚f) 

e = lim(n=>âˆ) (1+1/n)^n
e = (1+1/Ï‰)^Ï‰ = (1+Îµ)^Ï‰